#!/usr/bin/env python
import desitarget.mock.build


import os
import argparse
import yaml

parser = argparse.ArgumentParser()
parser.add_argument('output_dir')
parser.add_argument('--config','-c',default='fa_run.yaml')
parser.add_argument('--reset','-r',action='store_true')
args = parser.parse_args()

if not os.path.exists(args.config):
    raise Exception('No config file {} '.format(args.config))

print('Creating files under:   {}'.format(args.output_dir))
print('According to config in:    {}'.format(args.config))
print('')

# Read parameters from yaml
with open(args.config,'r') as pfile:
    params = yaml.load(pfile)

# Construct Targets and Truth files
desitarget.mock.build.targets_truth(params['sources'], args.output_dir)

print('done!')

